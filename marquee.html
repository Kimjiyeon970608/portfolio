<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    * {
      padding: 0;
      margin: 0;
      box-sizing: border-box;
    }

    .container {
      width: 100%;
    }

    .marquee {
      width: 100%;
      display: flex;
      overflow: hidden;
      white-space: nowrap;
      gap: 1rem;
    }

    .marquee-content {
      display: flex;
      gap: 1rem;
    }

    .marquee-content span {
      font-family: "Clash Display", sans-serif;
      font-size: 20vw;
      font-weight: 700;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="marquee" wb-data="marquee" duration="20" data-texts='["Yashraj Vaghela", "Frontend Developer", "Creative Designer"]'>
      <div class="marquee-content">
      </div>
    </div>
    
    <div class="marquee" wb-data="marquee" duration="15" data-texts='["React", "Vue.js", "JavaScript", "TypeScript"]'>
      <div class="marquee-content">
      </div>
    </div>
    
    <div class="marquee" wb-data="marquee" duration="25" data-texts='["Portfolio", "Projects", "Experience", "Skills"]'>
      <div class="marquee-content">
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
  <script>
    const initMarquee = (marqueeElement) => {
      if (!marqueeElement) {
        return;
      }
      
      const duration = parseInt(marqueeElement.getAttribute("duration"), 10) || 5;
      const textsData = marqueeElement.getAttribute("data-texts");
      const texts = textsData ? JSON.parse(textsData) : ["Default Text"];
      
      // marquee-content에 텍스트 동적 생성
      const marqueeContent = marqueeElement.querySelector('.marquee-content');
      if (!marqueeContent) {
        return;
      }
      
      // 기존 내용 제거
      marqueeContent.innerHTML = '';
      
      // 텍스트 배열로부터 span 요소 생성
      texts.forEach(text => {
        const span = document.createElement('span');
        span.textContent = text;
        marqueeContent.appendChild(span);
      });

      const marqueeContentClone = marqueeContent.cloneNode(true);
      marqueeElement.append(marqueeContentClone);

      let tween;

      const playMarquee = () => {
        let progress = tween ? tween.progress() : 0;
        tween && tween.progress(0).kill();
        const width = parseInt(
          getComputedStyle(marqueeContent).getPropertyValue("width"),
          10
        );

        const gap = parseInt(
          getComputedStyle(marqueeContent).getPropertyValue("column-gap"),
          10
        );

        const distanceToTranslate = -1 * (gap + width);

        tween = gsap.fromTo(
          marqueeElement.children,
          { x: 0 },
          { x: distanceToTranslate, duration, ease: "none", repeat: -1 }
        );
        tween.progress(progress);
      };
      playMarquee();

      function debounce(func) {
        var timer;
        return function (e) {
          if (timer) clearTimeout(timer);
          timer = setTimeout(
            () => {
              func();
            },
            500,
            e
          );
        };
      }

      window.addEventListener("resize", debounce(playMarquee));
    };

    const init = () => {
      // 모든 marquee 요소를 찾아서 각각 초기화
      const marquees = document.querySelectorAll('[wb-data="marquee"]');
      marquees.forEach(marquee => {
        initMarquee(marquee);
      });
    };

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>

</html>